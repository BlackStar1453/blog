{% extends "base.html" %}
{% block main %}
  <div class="archive-page">
    {# 聚合所有分类下的页面（覆盖子目录文章） #}
    {% set all_categories_archive = get_taxonomy(kind="categories",lang=lang) -%}
    {% set_global all_blog_pages_archive = [] -%}
    {% for cat in all_categories_archive.items -%}
      {% set_global all_blog_pages_archive = all_blog_pages_archive | concat(with=cat.pages) -%}
    {% endfor -%}
    {% set all_blog_pages_sorted_archive = all_blog_pages_archive | sort(attribute="date") | reverse -%}

    <div class="main-box-block">
      <h1>{{ page.title }}</h1>
      {% for year, posts in all_blog_pages_sorted_archive | group_by(attribute="year") %}
        <h2>{{ year }}</h2>
        <ul>
          {% for post in posts %}
            <li>{{ macro::post_min(page=post) }}</li>
          {% endfor %}
        </ul>
      {% endfor %}
    </div>
    {{ macro::webmentions(backlinks=page.backlinks) }}
  </div>
{% endblock main %}
